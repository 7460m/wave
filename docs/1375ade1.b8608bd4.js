(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{290:function(e,n,t){"use strict";t.d(n,"a",(function(){return b})),t.d(n,"b",(function(){return m}));var i=t(0),a=t.n(i);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=a.a.createContext({}),s=function(e){var n=a.a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},b=function(e){var n=s(e.components);return a.a.createElement(c.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.a.createElement(a.a.Fragment,{},n)}},d=a.a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),b=s(t),d=i,m=b["".concat(o,".").concat(d)]||b[d]||u[d]||r;return t?a.a.createElement(m,l(l({ref:n},c),{},{components:t})):a.a.createElement(m,l({ref:n},c))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=d;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var c=2;c<r;c++)o[c]=t[c];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},70:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return o})),t.d(n,"metadata",(function(){return l})),t.d(n,"rightToc",(function(){return p})),t.d(n,"default",(function(){return s}));var i=t(2),a=t(6),r=(t(0),t(290)),o={title:"Developer Guide",slug:"/enterprise/developer-guide"},l={unversionedId:"enterprise/developer-guide",id:"enterprise/developer-guide",isDocsHomePage:!1,title:"Developer Guide",description:"App Bundle Structure",source:"@site/docs/enterprise/developer-guide.md",slug:"/enterprise/developer-guide",permalink:"/wave/docs/enterprise/developer-guide",editUrl:"https://github.com/h2oai/wave/edit/master/website/docs/enterprise/developer-guide.md",version:"current",sidebar:"someSidebar",previous:{title:"Basic Concepts",permalink:"/wave/docs/enterprise/basic-concepts"},next:{title:"Gallery",permalink:"/wave/docs/examples"}},p=[{value:"App Bundle Structure",id:"app-bundle-structure",children:[{value:"q-app.toml",id:"q-apptoml",children:[]}]},{value:"Runtime Environment",id:"runtime-environment",children:[]},{value:"CLI",id:"cli",children:[{value:"Configuring the CLI",id:"configuring-the-cli",children:[]},{value:"Listing existing apps",id:"listing-existing-apps",children:[]},{value:"Launching existing apps",id:"launching-existing-apps",children:[]},{value:"Publishing an app for others to see and launch",id:"publishing-an-app-for-others-to-see-and-launch",children:[]},{value:"Running an app under development in q8s",id:"running-an-app-under-development-in-q8s",children:[]},{value:"Getting the logs of a running q8s instance",id:"getting-the-logs-of-a-running-q8s-instance",children:[]},{value:"Running the app in q8s-like environment locally",id:"running-the-app-in-q8s-like-environment-locally",children:[]},{value:"Updating App Visibility",id:"updating-app-visibility",children:[]},{value:"Updating Instance Visibility",id:"updating-instance-visibility",children:[]}]},{value:"How-To",id:"how-to",children:[{value:"Updating App To a Newer Version",id:"updating-app-to-a-newer-version",children:[]},{value:"Utilizing Secrets",id:"utilizing-secrets",children:[]},{value:"App Route",id:"app-route",children:[]}]}],c={rightToc:p};function s(e){var n=e.components,t=Object(a.a)(e,["components"]);return Object(r.b)("wrapper",Object(i.a)({},c,t,{components:n,mdxType:"MDXLayout"}),Object(r.b)("h2",{id:"app-bundle-structure"},"App Bundle Structure"),Object(r.b)("p",null,"Each q8s-compatible app has to be bundled as a zip archive (commonly used with suffix ",Object(r.b)("inlineCode",{parentName:"p"},".qz"),")\nconsisting of:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"wave-app.toml")," - to q8s configuration file"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"static/")," - static asset directory, including the app icon (a png file starting with ",Object(r.b)("inlineCode",{parentName:"li"},"icon"),")\nand screenshots (files starting with ",Object(r.b)("inlineCode",{parentName:"li"},"screenshot"),")"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"requirements.txt")," - pip-managed dependencies of the app (can contain references to ",Object(r.b)("inlineCode",{parentName:"li"},".whl")," files\nincluded in the ",Object(r.b)("inlineCode",{parentName:"li"},".qz")," using paths relative to the archive root)"),Object(r.b)("li",{parentName:"ul"},"app source code")),Object(r.b)("p",null,"You can quickly create a ",Object(r.b)("inlineCode",{parentName:"p"},".qz")," archive by running ",Object(r.b)("inlineCode",{parentName:"p"},"q8s-cli bundle")," in your app git repository\n(see the ",Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"#cli"}),"CLI")," section)"),Object(r.b)("h3",{id:"q-apptoml"},"q-app.toml"),Object(r.b)("p",null,"Each q8s-compatible app has to contain a ",Object(r.b)("inlineCode",{parentName:"p"},"q-app.toml")," configuration file in the ",Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"https://toml.io/en/"}),"TOML")," format,\nplaced in the root of the ",Object(r.b)("inlineCode",{parentName:"p"},".qz")," archive, example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-toml"}),'[App]\nName = "ai.h2o.q.my-app"\nVersion = "0.0.1"\nTitle = "My awesome app"\nDescription = "This is my awesome app"\nCategory = "Other"\nKeywords = ["awesome"]\n\n[Runtime]\nModule = "q_app.run"\nVolumeMount = "/data"\nVolumeSize = "1Gi"\nMemoryLimit = "500Mi"\nMemoryReservation = "400Mi"\n\n[[Env]]\nName = "ENVIRONMENT_VARIABLE_NAME"\nSecret = "SecretName"\nSecretKey = "SecretKeyName"\n\n[[Env]]\nName = "ANOTHER_ENVIRONMENT_VARIABLE_NAME"\nSecret = "SecretName"\nSecretKey = "AnotherSecretKeyName"\n')),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Required attributes"),":"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"App"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Name")," - a machine-oriented unique identifier of the app (links different app versions together)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Version")," - a ",Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"https://semver.org"}),"https://semver.org")," version of the app"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Runtime"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Module")," - the name of the main Python module of the app, i.e., the app should be started\nvia ",Object(r.b)("inlineCode",{parentName:"li"},"python3 -m $module_name"))))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Optional attributes"),":"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"App"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Title")," - a human-oriented name of the app for presentation in UI/CLI; string"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Description")," - a multiline description of the app for presentation in UI/CLI; string"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Category")," - category for organizing apps into groups, string\n(UI recognizes ",Object(r.b)("inlineCode",{parentName:"li"},"All"),", ",Object(r.b)("inlineCode",{parentName:"li"},"Data Science"),", ",Object(r.b)("inlineCode",{parentName:"li"},"Financial Services"),", ",Object(r.b)("inlineCode",{parentName:"li"},"Healthcare"),", ",Object(r.b)("inlineCode",{parentName:"li"},"Insurance"),",\n",Object(r.b)("inlineCode",{parentName:"li"},"Manufacturing"),", ",Object(r.b)("inlineCode",{parentName:"li"},"Marketing"),", ",Object(r.b)("inlineCode",{parentName:"li"},"Retail"),", ",Object(r.b)("inlineCode",{parentName:"li"},"Sales"),", ",Object(r.b)("inlineCode",{parentName:"li"},"Telecommunications"),", and ",Object(r.b)("inlineCode",{parentName:"li"},"Other"),")"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Keywords")," - keywords for search in the UI/CLI, list of strings"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Runtime"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"VolumeMount")," and ",Object(r.b)("inlineCode",{parentName:"li"},"VolumeSize")," - request for a volume to persist app instance data across\nrestarts, ",Object(r.b)("inlineCode",{parentName:"li"},"VolumeMount")," has to be an absolute path, ",Object(r.b)("inlineCode",{parentName:"li"},"VolumeSize")," needs to conform to the\n",Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"https://github.com/fabric8io/kansible/blob/master/vendor/k8s.io/kubernetes/docs/design/resources.md#resource-quantities"}),"k8s resource model"),"."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"MemoryLimit")," and ",Object(r.b)("inlineCode",{parentName:"li"},"MemoryReservation")," - memory requirements for an instance of the app\n(default to service-wide settings managed by Admins); be conservative with these limits;\n",Object(r.b)("inlineCode",{parentName:"li"},"MemoryLimit")," is a hard limit on the maximum amount of memory an instance can use before it is OOM-killed;\n",Object(r.b)("inlineCode",{parentName:"li"},"MemoryReservation")," is how much memory is required to schedule an instance of the app."))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Env")," - request for a configuration/secret to be injected into an instance at startup-time as an Env variable;\nrepeated; see ",Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"#utilizing-secrets"}),"Utilizing Secrets"),".",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Name")," - name of the Env variable to the injected into the Python process"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Secret")," - name of the shared secret to use; each secret can contain multiple key-value pairs"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"SecretKey")," - name of the key within the secret to use")))),Object(r.b)("h2",{id:"runtime-environment"},"Runtime Environment"),Object(r.b)("p",null,"Q8s configures the app instance runtime environment, i.e., OS, OS dependencies, location of the app code/venv, etc."),Object(r.b)("p",null,"Developers can specify the pip-managed dependencies of the app via ",Object(r.b)("inlineCode",{parentName:"p"},"requirements.txt")," (can contain\nreferences to ",Object(r.b)("inlineCode",{parentName:"p"},".whl")," files included in the ",Object(r.b)("inlineCode",{parentName:"p"},".qz")," using paths relative to the archive root)"),Object(r.b)("p",null,"Developers can further customize the runtime environment by ",Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"#utilizing-secrets"}),"Utilizing Secrets"),"."),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",Object(i.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(i.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(i.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(r.b)("path",Object(i.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(r.b)("div",Object(i.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"At this moment, q8s does not provide any provisions for developers to customize the OS,\nnative OS dependencies, Qd version, etc."),Object(r.b)("p",{parentName:"div"},"We are actively working on improving this."))),Object(r.b)("h2",{id:"cli"},"CLI"),Object(r.b)("p",null,"As a developer, you will need the ",Object(r.b)("inlineCode",{parentName:"p"},"q8s-cli")," binary to interact with the q8s service."),Object(r.b)("h3",{id:"configuring-the-cli"},"Configuring the CLI"),Object(r.b)("p",null,"First you need to configure the CLI by running ",Object(r.b)("inlineCode",{parentName:"p"},"q8s-cli config setup")," so that it knows how to talk\nto a particular q8s deployment."),Object(r.b)("p",null,"Be aware, currently the CLI launches a browser to complete the user authentication, and due to this\nwe currently unable to support remote use of the CLI over SSH without provisions for X forwarding."),Object(r.b)("h3",{id:"listing-existing-apps"},"Listing existing apps"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"q8s-cli app list -a")," command will list all apps available for launch."),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-sh"}),"$ q8s-cli app list -a\nID                                   TITLE                          OWNER            CREATED UPDATED CATEGORY      VISIBILITY\nabc543210-0000-0000-0000-1234567890ab Q Peak 0.1.1                   user1@h2o.ai     18d     18d     Healthcare    ALL_USERS\nbcd543210-1111-1111-1111-0123456789ab Q Tour 0.0.15-20200922162859   user2@h2o.ai     20d     20d     Other         ALL_USERS\n...\n")),Object(r.b)("h3",{id:"launching-existing-apps"},"Launching existing apps"),Object(r.b)("p",null,"To launch an app, the ",Object(r.b)("inlineCode",{parentName:"p"},"q8s-cli app run <appId>")," command can be used to launch a new instance of that app.\nThe ",Object(r.b)("inlineCode",{parentName:"p"},"-v")," flag can be used with ",Object(r.b)("inlineCode",{parentName:"p"},"app run")," to specify app instance visibility settings."),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-sh"}),"$ q8s-cli app run bcd543210-1111-1111-1111-0123456789ab\nID  22222222-3333-4444-5555-666666666666\nURL https://22222222-3333-4444-5555-666666666666.q8s.h2o.ai\n")),Object(r.b)("h3",{id:"publishing-an-app-for-others-to-see-and-launch"},"Publishing an app for others to see and launch"),Object(r.b)("p",null,"Just run ",Object(r.b)("inlineCode",{parentName:"p"},"q8s-cli bundle import")," in your app git repository. This will automatically package your\ncurrent directory into a ",Object(r.b)("inlineCode",{parentName:"p"},".qz")," package and import it to q8s."),Object(r.b)("p",null,"If you set the visibility to ",Object(r.b)("inlineCode",{parentName:"p"},"ALL_USERS")," (via the ",Object(r.b)("inlineCode",{parentName:"p"},"-v")," flag), others will be able use ",Object(r.b)("inlineCode",{parentName:"p"},"q8s-cli app run"),"\nor the UI to launch the app in q8s."),Object(r.b)("p",null,"Note: the name-version combination from your ",Object(r.b)("inlineCode",{parentName:"p"},"q-app.toml")," has to be unique and q8s will reject\nthe request if such combination already exists. Therefore, you need to update the version in ",Object(r.b)("inlineCode",{parentName:"p"},"q-app.toml"),"\nbefore each run."),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-sh"}),"$ q8s-cli bundle import -v ALL_USERS\nID              bcd543210-1111-1111-1111-0123456789ab\nTitle           Q Peak\nVersion         0.1.2\nCategory        Healthcare\nCreated At      2020-10-13 06:28:03.050226 +0000 UTC\nUpdated At      2020-10-13 06:28:03.050226 +0000 UTC\nOwner           user1@h2o.ai\nVisibility      ALL_USERS\nBundle Location ai.h2o.q.peak.0.1.2.qz\nIcon Location   ai.h2o.q.peak.0.1.2/icon.jpg\nDescription     Forecast of COVID-19 spread\n")),Object(r.b)("h3",{id:"running-an-app-under-development-in-q8s"},"Running an app under development in q8s"),Object(r.b)("p",null,"Just run ",Object(r.b)("inlineCode",{parentName:"p"},"q8s-cli bundle deploy")," in your app git repository. This will automatically package your\ncurrent directory into a ",Object(r.b)("inlineCode",{parentName:"p"},".qz")," package, import it to q8s, and run it."),Object(r.b)("p",null,'In the output you will be able to find a URL where you can reach the instance, or visit\nthe "My Instances" in the UI.'),Object(r.b)("p",null,"Note: q8s will auto-generate the version so that you can keep executing this without worrying about\nversion conflicts, just don't forget to clean up old instances/versions."),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-sh"}),"$ q8s-cli bundle deploy\nID              bcd543210-1111-1111-1111-0123456789ab\nTitle           Q Peak\nVersion         0.1.2-20201013062803\nCategory        Healthcare\nCreated At      2020-10-13 06:28:03.050226 +0000 UTC\nUpdated At      2020-10-13 06:28:03.050226 +0000 UTC\nOwner           user1@h2o.ai\nVisibility      PRIVATE\nBundle Location ai.h2o.q.peak.0.1.2-20201013062803.qz\nIcon Location   ai.h2o.q.peak.0.1.2-20201013062803/icon.jpg\nDescription     Forecast of COVID-19 spread\nID  22222222-3333-4444-5555-666666666666\nURL https://22222222-3333-4444-5555-666666666666.q8s.h2o.ai\n")),Object(r.b)("h3",{id:"getting-the-logs-of-a-running-q8s-instance"},"Getting the logs of a running q8s instance"),Object(r.b)("p",null,"Just run ",Object(r.b)("inlineCode",{parentName:"p"},"q8s-cli instance logs"),", use the flag ",Object(r.b)("inlineCode",{parentName:"p"},"-f")," (",Object(r.b)("inlineCode",{parentName:"p"},"--follow"),") to tail the log."),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-sh"}),'$ q8s-cli instance logs c22222222-3333-4444-5555-666666666666\n...\n2020/10/15 12:04:40 # \n2020/10/15 12:04:40 # \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n2020/10/15 12:04:40 # \u2502   \u252c \u252c\u250c\u2500\u2510\u252c  \u252c\u250c\u2500\u2510   \u2502\n2020/10/15 12:04:40 # \u2502   \u2502\u2502\u2502\u251c\u2500\u2524\u2514\u2510\u250c\u2518\u251c\u2524    \u2502\n2020/10/15 12:04:40 # \u2502   \u2514\u2534\u2518\u2534 \u2534 \u2514\u2518 \u2514\u2500\u2518   \u2502\n2020/10/15 12:04:40 # \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n2020/10/15 12:04:40 # \n2020/10/15 12:04:40 # {"address":":55555","t":"listen","webroot":"/wave/www"}\n2020/10/15 12:04:40 # {"host":"ws://127.0.0.1:55556","route":"/","t":"relay"}\n...\n')),Object(r.b)("h3",{id:"running-the-app-in-q8s-like-environment-locally"},"Running the app in q8s-like environment locally"),Object(r.b)("p",null,"Just run ",Object(r.b)("inlineCode",{parentName:"p"},"q8s-cli exec"),". This will bundle the app in a temporary ",Object(r.b)("inlineCode",{parentName:"p"},".qz")," and launch it locally\nusing our q8s docker image."),Object(r.b)("p",null,"Note that this requires that you have docker installed and that you have access to the docker image."),Object(r.b)("p",null,"Then navigate to ",Object(r.b)("inlineCode",{parentName:"p"},"http://localhost:55555/<your main route>"),"."),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-sh"}),'$ q8s-cli exec\n{"level":"info","log_level":"debug","url":"file:///qz/q-peak.0.1.2.qz","app_root":"/app","venv_root":"/resources","server_path":"/wave/wave","py_module":"peak","tmp":"/tmp","startup_server":true,"version":"latest-20200929","time":"2020-10-13T06:42:21Z","message":"configuration"}\n{"level":"info","port":":55555","time":"2020-10-13T06:42:21Z","message":"starting launcher server"}\n{"level":"info","executable":"/wave/wave","time":"2020-10-13T06:42:21Z","message":"q executable found"}\n...\n')),Object(r.b)("h3",{id:"updating-app-visibility"},"Updating App Visibility"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"q8s-cli app update <appId> -v <visbility>")," command can be used to modify an existing app's visibility."),Object(r.b)("p",null,"Authors who publish a new version of an app may want to de-list the old version.  It is not possible\nto remove an app if there are instances running, as the data may still need to be available.\nThe preferred method to de-list previous versions is to modify the visibility setting to ",Object(r.b)("inlineCode",{parentName:"p"},"PRIVATE"),"."),Object(r.b)("h3",{id:"updating-instance-visibility"},"Updating Instance Visibility"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"q8s-cli instance update <instanceId> -v <visbility>")," command, much like the ",Object(r.b)("inlineCode",{parentName:"p"},"app")," version,\ncan be used to modify an existing running instance's visibility setting."),Object(r.b)("h2",{id:"how-to"},"How-To"),Object(r.b)("h3",{id:"updating-app-to-a-newer-version"},"Updating App To a Newer Version"),Object(r.b)("p",null,'The "Catalog" page shows apps with visibility ',Object(r.b)("inlineCode",{parentName:"p"},"ALL_USERS"),", so rolling out a new app version is done by:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"#publishing-an-app-for-others-to-see-and-launch"}),"importing a new version")," of the app as ",Object(r.b)("inlineCode",{parentName:"li"},"PRIVATE")),Object(r.b)("li",{parentName:"ol"},"testing the new version"),Object(r.b)("li",{parentName:"ol"},Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"#updating-app-visibility"}),"changing the visibility")," of the new version to ",Object(r.b)("inlineCode",{parentName:"li"},"ALL USERS")),Object(r.b)("li",{parentName:"ol"},"(optional) ",Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"#updating-app-visibility"}),"changing the visibility")," of the old version to ",Object(r.b)("inlineCode",{parentName:"li"},"PRIVATE"))),Object(r.b)("p",null,"This is based on the ",Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"basic-concepts#app"}),"Basic Concepts"),":"),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"Apps are mostly ",Object(r.b)("strong",{parentName:"p"},"immutable"),', meaning once uploaded, they cannot be changed (except for visibility).\nTo "update" an app, one has to upload a new version.')),Object(r.b)("p",null,"and:"),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"Internally, H2O AI Cloud treats every app name/version combination as a separate entity.\nThe UI then uses the app name to link several versions together; however each can have different\ntitle, description, owner, instances, etc.")),Object(r.b)("p",null,"An important corollary is that ",Object(r.b)("strong",{parentName:"p"},"instances of the old app version are not affected by the update"),"\n(as they are completely separate from the new app version). The update only prevents users from\nstarting new instances of the old version."),Object(r.b)("h3",{id:"utilizing-secrets"},"Utilizing Secrets"),Object(r.b)("p",null,"Developers can pass secrets registered with q8s to apps, exposed as environment variables, using\nthe ",Object(r.b)("inlineCode",{parentName:"p"},"[[Env]]")," section within the ",Object(r.b)("inlineCode",{parentName:"p"},"q-app.toml"),"."),Object(r.b)("p",null,"This allows developers to link their apps with external dependencies (e.g., S3, Driverless AI)\nsecurely, while allowing easy overrides for local development."),Object(r.b)("p",null,"Environment variables prefixed with ",Object(r.b)("inlineCode",{parentName:"p"},"Q8S")," are disallowed."),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",Object(i.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(i.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(i.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(r.b)("path",Object(i.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(r.b)("div",Object(i.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"There is currently not a self-service option for developers to add their own secrets,\nnor is there an API for listing the available secrets.\nSecrets are currently managed by Admins.\nContact your admins for the available secrets or for adding a new one."),Object(r.b)("p",{parentName:"div"},"We are actively working on improving this."))),Object(r.b)("h3",{id:"app-route"},"App Route"),Object(r.b)("p",null,"While it is not a strict requirement, since each app in q8s is deployed with its own Qd,\nit is advised that apps use ",Object(r.b)("inlineCode",{parentName:"p"},"/")," as its main route:"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-python"}),"if __name__ == '__main__':\n    listen('/', main_page)\n")))}s.isMDXComponent=!0}}]);